<div class="dashboard-container container">
  <div class="dashboard-header">
    <h1>Dashboard</h1>
    <p class="subtitle">Monitor system status and recent activity</p>
  </div>

  <!-- Service Status -->
  <div class="card">
    <div class="card-header">System Status</div>
    <div class="grid grid-4">
      <div class="status-card" *ngFor="let service of serviceStatus | keyvalue">
        <div class="status-info">
          <span [class]="'status-indicator ' + getStatusClass(service.value.status)"></span>
          <span class="service-name">{{ service.value.name }}</span>
        </div>
        <div class="status-label">
          {{ service.value.status === 'online' ? 'Running' : service.value.status === 'offline' ? 'Offline' : 'Checking...' }}
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics -->
  <div class="grid grid-2">
    <div class="stat-card card">
      <div class="stat-icon error-icon">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="10" stroke-width="2"/>
          <line x1="12" y1="8" x2="12" y2="12" stroke-width="2"/>
          <line x1="12" y1="16" x2="12.01" y2="16" stroke-width="2"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ errorCount }}</div>
        <div class="stat-label">Active Errors</div>
      </div>
    </div>

    <div class="stat-card card">
      <div class="stat-icon pr-icon">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M16 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V8l-5-5z" stroke-width="2"/>
          <polyline points="9 12 11 14 15 10" stroke-width="2"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ prCount }}</div>
        <div class="stat-label">Pull Requests</div>
      </div>
    </div>
  </div>

  <!-- Recent Errors -->
  <div class="card">
    <div class="card-header">
      Recent Errors
      <a routerLink="/errors" class="view-all">View All →</a>
    </div>
    
    <div *ngIf="loading" class="text-center">
      <div class="spinner"></div>
    </div>

    <div *ngIf="!loading && recentErrors.length === 0" class="empty-state">
      <p>No errors found</p>
    </div>

    <div class="error-list" *ngIf="!loading && recentErrors.length > 0">
      <div class="error-item" *ngFor="let error of recentErrors">
        <div class="error-info">
          <div class="error-message">{{ error.error.message }}</div>
          <div class="error-meta">
            <span class="badge badge-error">{{ error.error.type }}</span>
            <span class="meta-text">{{ error.containerName }}</span>
            <span class="meta-text">{{ error.occurrenceCount }} occurrences</span>
          </div>
        </div>
        <div class="error-actions">
          <button class="btn btn-primary" [routerLink]="['/diagnostic', error.transactionId]">
            Diagnose
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent PRs -->
  <div class="card" *ngIf="recentPRs.length > 0">
    <div class="card-header">
      Recent Pull Requests
      <a routerLink="/prs" class="view-all">View All →</a>
    </div>
    <div class="pr-list">
      <div class="pr-item" *ngFor="let pr of recentPRs">
        <div class="pr-info">
          <div class="pr-title">{{ pr.title }}</div>
          <div class="pr-meta">
            <span class="badge badge-success">#{{ pr.prNumber }}</span>
            <span class="meta-text">{{ pr.branch }}</span>
          </div>
        </div>
        <a [href]="pr.prUrl" target="_blank" class="btn btn-secondary">View PR</a>
      </div>
    </div>
  </div>
</div>
